async function requireAuth(){
  if(isAdmin()) return true;

  const wrap = qs("#loginWrap");
  const pass = qs("#loginPass");
  const okBtn = qs("#loginOk");
  const cancelBtn = qs("#loginCancel");
  const err = qs("#loginError");

  function open(){
    wrap.classList.add("open");
    wrap.setAttribute("aria-hidden","false");
    err.style.display = "none";
    pass.value = "";
    setTimeout(()=>pass.focus(), 50);
  }
  function close(){
    wrap.classList.remove("open");
    wrap.setAttribute("aria-hidden","true");
  }

  return await new Promise((resolve)=>{
    open();

    const cleanup = ()=>{
      okBtn.removeEventListener("click", onOk);
      cancelBtn.removeEventListener("click", onCancel);
      wrap.removeEventListener("click", onBackdrop);
      pass.removeEventListener("keydown", onKey);
    };

    const onOk = ()=>{
      if(pass.value === ADMIN_PASSWORD){
        setAdminSession(true);
        close();
        cleanup();
        resolve(true);
      }else{
        err.style.display = "block";
        pass.select();
      }
    };

    const onCancel = ()=>{
      close();
      cleanup();
      location.href = "index.html";
      resolve(false);
    };

    const onBackdrop = (e)=>{
      if(e.target === wrap) onCancel();
    };

    const onKey = (e)=>{
      if(e.key === "Enter") onOk();
      if(e.key === "Escape") onCancel();
    };

    okBtn.addEventListener("click", onOk);
    cancelBtn.addEventListener("click", onCancel);
    wrap.addEventListener("click", onBackdrop);
    pass.addEventListener("keydown", onKey);
  });
}